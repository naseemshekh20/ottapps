"use strict";function ajax(e){var t=e.method,r=void 0===t?"GET":t,n=e.url,o=e.data,i=e.raw,s=e.headers,a=void 0===s?{}:s;return new Promise(function(e,t){var s=new window.XMLHttpRequest;s.withCredentials=!0;var d=!1;s.ontimeout=function(){d=!0},s.open(r,n);for(var l in a)s.setRequestHeader(l,a[l]);s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.onreadystatechange=function(){if(d&&t(),4===s.readyState){var r=s.status,n=r>=200&&r<300||304===r,o=s.responseText;if(i)n?e(o):t({status:r,response:o});else{var a=void 0;try{a=JSON.parse(s.responseText)}catch(e){n=!1}n?e(a):t({status:r,json:a})}}},s.send(stringifyParams(_extends({"X-Plex-Client-Identifier":plexClientIdentifier},o)))})}function getByPostMessage(e){var t=$.Deferred();return getPostMessage({url:replaceUrlProtocol(window.location.origin,"https:")+"/service-reflector",data:e,timeout:5e3,onMessage:function(e){!0===e.success?t.resolve(e.data,getStatusText(e.xhr),e.xhr):!1===e.success&&t.reject(e.xhr,getStatusText(e.xhr))}}),t.promise()}function getPostMessage(e){function t(){window.document.body.removeChild(d),window.removeEventListener("message",r),clearTimeout(a)}function r(e){if(e.source===d.contentWindow){var r=void 0;try{r=JSON.parse(e.data)}catch(e){}r&&(i(r),t())}}var n=e.url,o=e.data,i=e.onMessage,s=e.timeout,a=setTimeout(function(){i({success:!1}),t()},s);window.addEventListener("message",r);var d=window.document.createElement("iframe");d.style.display="none",d.src=n+"#"+encodeURIComponent(JSON.stringify({data:o})),window.document.body.appendChild(d)}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){var r={isUnrecoverable:function(e,t){return!e||e.some(function(e){return 1056===e.code||1064===e.code&&"facebook"===t||e.isUnrecoverable})},isRecoverableByClearingProviderAuth:function(e,t){return"google"===t&&e.some(function(e){return 1064===e.code})},isAdditionalAuthNeeded:function(e){return e.some(function(e){return 1044===e.code})},isAdditionalAuthPassword:function(e){return e.some(function(e){return 1044===e.code&&!0===e.hasPassword})},additionalAuthProviderIDs:function(e){return e.reduce(function(e,t){return 1044===t.code&&t.providers.split(",").forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),e},[])},getErrorEmail:function(e){return 1044===e.code?e.email:null},additionalAuthEmail:function(e){var t=e.find(r.getErrorEmail);return t?r.getErrorEmail(t):null},isIgnorable:function(e){return e.some(function(e){return e.isIgnorable})},getSignInErrorMessage:function(e){var t=e&&e[0];return t?"object"===(void 0===t?"undefined":_typeof(t))?t:{code:0,message:t}:{code:0,message:"There was a problem signing in to Plex."}},trackMetricsEvents:function(){function e(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}var t=PlexModel.getSignInModel().get(),r="fedAuth"+e(t.action)+e(t.providerID)+"["+(t.isModal?"modal":"page")+"]";PlexMetrics.pushEvent(r)}};t.PlexHelpers=r}(jQuery,window);var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};!function(e,t){var r={run:function(r){var n=r.method,o=void 0===n?"GET":n,i=r.url,s=r.data,a=r.raw,d=r.headers,l=void 0===d?{}:d;return new Promise(function(r,n){var d=new t.XMLHttpRequest;d.withCredentials=!0;var u=!1;d.ontimeout=function(){u=!0},d.open(o,i);for(var c in l)d.setRequestHeader(c,l[c]);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),d.onreadystatechange=function(){if(u&&n(),4===d.readyState){var e=d.status,t=e>=200&&e<300||304===e,o=d.responseText;if(a)t?r(o):n({status:e,response:o});else{var i=void 0;try{i=JSON.parse(d.responseText)}catch(e){t=!1}t?r(i):n({status:e,json:i})}}};var f=_extends({"X-Plex-Client-Identifier":Plex.getClientIdentifier()},s);d.send(e.param(f))})},getUserAPIPromise:function(t){var r={"X-Plex-Product":"Plex SSO","X-Plex-Client-Identifier":Plex.getClientIdentifier()};return t.headers=_extends({},r,t.headers||{}),e.ajax(t)},minDuration:function(t,r){function n(){var e=(new Date).getTime(),t=Math.max(i-e,0);setTimeout(s,t)}var o=e.Deferred(),i=(new Date).getTime()+r,s=void 0;return t.then(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s=function(){return o.resolve.apply(o,t)}},function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s=function(){return o.reject.apply(o,t)}}),t.then(n,n),o.promise()},maxDuration:function(t,r){var n=e.Deferred(),o=setTimeout(function(){n.reject()},r);return t.then(n.resolve,n.reject).always(function(){clearTimeout(o)}),n.promise()},alwaysResolve:function(t){var r=e.Deferred();return t&&t.then?t.then(r.resolve,r.resolve):r.resolve(t),r.promise()}};t.PlexAjax=r}(jQuery,window);var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};!function(e,t){function r(){return n().then(o)}function n(){if("undefined"!=typeof gapi)return e.Deferred().resolve().promise();var r=e.Deferred(),n=t.document.createElement("script");return n.src="https://apis.google.com/js/api.js",n.async=!0,n.defer=!0,n.onload=function(){r.resolve()},n.onreadystatechange=function(){"complete"===n.readyState&&r.resolve()},n.onerror=function(){r.reject(["Could not reach Google"])},r.always(function(){t.document.body.removeChild(n),n.onload=null,n.onerror=null}),t.document.body.appendChild(n),r.promise()}function o(){var t=e.Deferred();return gapi.load("client:auth2",function(){var e=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];gapi.client.init({apiKey:u,clientId:c,scope:l.join(" "),discoveryDocs:e}).then(function(){t.resolve()},function(){t.reject()})}),t.promise()}function i(t){return t.hasGrantedScopes(l.join(" "))?e.Deferred().resolve(t.getAuthResponse().id_token).promise():e.Deferred().reject().promise()}function s(){var t=gapi.auth2.getAuthInstance(),r=t.currentUser.get(),n=r.getBasicProfile();return e.Deferred().resolve(n.getEmail()).promise()}function a(){var t=e.Deferred(),r=gapi.auth2.getAuthInstance(),n=r.currentUser.get();return n.reloadAuthResponse().then(function(){t.resolve(n)},function(){t.reject()}),t.promise()}function d(){var t=e.Deferred();return gapi.auth2.getAuthInstance().signIn().then(function(e){t.resolve()},function(e){t.reject([{isIgnorable:!0}])}),t.promise()}var l=["email","profile"],u="AIzaSyAZQ6pxlxG7Taa8W7ons7idJAfG1W9qriE",c="954396107311-vpdi0ie6905j1pr8udc2v1drm9p0kn0p.apps.googleusercontent.com",f={preload:function(){return PlexAjax.maxDuration(r(),3e4).then(function(){return PlexAjax.alwaysResolve(a().then(function(t){return e.when(i(t),s())}).then(function(e,t){return{providerToken:e,email:t}},function(){return{}}))})},auth:function(e,t){return PlexAuthFederated.isFederatedAuthSubmittable(e)?PlexAuthFederated.authFederated(e,t):d().then(a).then(i).then(function(r){return PlexAuthFederated.authFederated(_extends({},e,{providerToken:r}),t)})}};t.PlexAuthGoogle=f}(jQuery,window);var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};!function(e,t){function r(){if("undefined"!=typeof FB)return e.Deferred().resolve().promise();var r=e.Deferred(),n=document.createElement("script");return n.src="//connect.facebook.net/en_US/sdk.js",n.onerror=function(){r.reject()},t.fbAsyncInit=function(){FB.init({appId:g,cookie:!0,xfbml:!1,version:"v2.9"}),FB.AppEvents.logPageView(),FB.getLoginStatus(function(e){r.resolve()},!0)},r.always(function(){t.document.body.removeChild(n),n.onerror=null,delete t.fbAsyncInit}),t.document.body.appendChild(n),r.promise()}function n(){var t=e.Deferred();return FB.api("/me/permissions",function(e){if(e.error)return void t.reject([e.error.message]);0===e.data.reduce(function(e,t){var r=t.permission,n=t.status;return-1===l.indexOf(r)?e:("granted"===n?e.granted.push(r):e.missing.push(r),e)},{missing:[],granted:[]}).missing.length?t.resolve():t.reject(["Plex needs access to your Facebook email address"])}),t.promise()}function o(){var t=e.Deferred();return FB.getLoginStatus(function(e){"connected"===e.status?t.resolve():t.reject()}),t.promise()}function i(t){var r=e.Deferred();return FB.login(function(e){!e.error&&e.authResponse||r.reject([{isIgnorable:!0}]),r.resolve()},{scope:l.join(","),auth_type:t}),r.promise()}function s(){var t=FB.getAuthResponse(),r=t.accessToken;return e.Deferred().resolve(r).promise()}function a(){var t=e.Deferred();return FB.api("/me",{fields:"email"},function(e){t.resolve(e.email)}),PlexAjax.maxDuration(t.promise(),u)}function d(e){return o().then(function(){return i(f)},function(){return i(c)})}var l=["email","public_profile"],u=1e4,c=null,f="rerequest",g="1405987639482438",p={preload:function(){return PlexAjax.maxDuration(r(),3e4).then(function(){var t=o(),r=t.then(n),i=r.then(function(){return e.when(s(),a())}).then(function(e,t){return{providerToken:e,email:t}},function(){return{}});return PlexAjax.alwaysResolve(i)})},auth:function(e,t){return PlexAuthFederated.isFederatedAuthSubmittable(e)?PlexAuthFederated.authFederated(e,t):d(e).then(n).then(s).then(function(r){return PlexAuthFederated.authFederated(_extends({},e,{providerToken:r}),t)})}};t.PlexAuthFacebook=p}(jQuery,window),function(e,t){var r={LOAD_FEDERATED_AUTH_PROVIDER_HELPERS:{facebook:PlexAuthFacebook.preload,google:PlexAuthGoogle.preload},USE_FEDERATED_AUTH_PROVIDER_HELPERS:{facebook:PlexAuthFacebook.auth,google:PlexAuthGoogle.auth},federatedAuthProviders:{google:{providerID:"google",label:"Google"},facebook:{providerID:"facebook",label:"Facebook"}},authFederated:function(t,r){var n=e.Deferred(),o=PlexUtils.getAPIUrl()+"/api/v2/users/authenticate";return r.authToken&&(t["X-Plex-Token"]=r.authToken),PlexAjax.getUserAPIPromise({url:o,type:"POST",data:t,dataType:"json",xhrFields:{withCredentials:!0}}).done(function(e){n.resolve({authToken:e.authToken,uuid:e.uuid,metricsEvent:e.created?PlexSignUp.SIGN_UP:PlexSignIn.SIGN_IN,metricsMode:t.provider,isFirstRun:r.isFirstRun,response:e})}).then(null,function(e){var t=e&&e.status?e.responseJSON.errors:null;n.reject(t)}),n.promise()},isFederatedAuthSubmittable:function(e){var t=e.provider,r=e.providerToken,n=e.verifyProvider,o=e.verifyProviderToken;return t&&r&&(!n||n&&o)}};t.PlexAuthFederated=r}(jQuery,window),function(e,t){var r={providers:[],signIn:null},n={set:function(t){this.sessionAttrs=e.extend(!0,this.sessionAttrs,t)},get:function(){return this.sessionAttrs},reset:function(){this.sessionAttrs=e.extend(!0,this.sessionAttrs,this.defaults)}},o={signin:{title:"Sign In",class:".signin-dynamic"},signup:{title:"Sign Up",class:".signup-dynamic"},reset:{title:"Reset Password",class:".reset-dynamic"}},i=e.extend({name:"SignInPageModel",defaults:{departureMessage:"",errorMessage:"",myPlexAccessToken:"",providerID:"",providerToken:"",isBusy:!1,isAdditionalAuthNeeded:!1,isAdditionalAuthPassword:!1,isSuccess:!1,isModalAuth:!1,additionalAuthEmail:"",additionalAuthProviderIDs:[],ssoEmail:"",ssoMyPlexAccessToken:"",isResetPasswordSubmitted:!1,isResetPasswordError:!1},sessionAttrs:{action:"signin",isModal:!1,isSignUp:!1,redirectWeb:!0,departureMessage:"",errorMessage:"",myPlexAccessToken:"",providerID:"",providerToken:"",isBusy:!1,isAdditionalAuthNeeded:!1,isAdditionalAuthPassword:!1,isSuccess:!1,isModalAuth:!1,additionalAuthEmail:"",additionalAuthProviderIDs:[],ssoEmail:"",ssoMyPlexAccessToken:"",isResetPasswordSubmitted:!1,isResetPasswordError:!1}},n),s=e.extend({name:"FederatedAuthProviderModel",context:["signInPageModel"],rootPropertyName:"provider",sessionAttrs:{isLoading:!0,isError:!1,label:"",providerID:"",providerToken:"",email:""}},n),a={getFormModel:function(e){return o[e]},getFedAuthProviderModel:function(t,n){var o=e.extend(!0,{},s);return void 0!==n?o:(r.providers[t]=e.extend(!0,o,r.providers[t]),r.providers[t])},getSignInModel:function(){var t=e.extend(!0,{},i);return r.signIn=e.extend(!0,t,r.signIn),r.signIn}};t.PlexModel=a}(jQuery,window),function(e,t){var r={SIGN_IN:"signin",signIn:function(t,n){return t=e.extend(!0,t,{includeProviders:!0}),PlexAjax.getUserAPIPromise({url:PlexUtils.getAPIUrl()+"/api/v2/users/signin",type:"POST",data:t,dataType:"json",xhrFields:{withCredentials:!0}}).then(function(e){return{authToken:e.authToken,uuid:e.uuid,metricsEvent:r.SIGN_IN,metricsMode:"password",metricsFirstRun:!0,isFirstRun:n.isFirstRun,response:e}},function(t){return e.Deferred().reject(t&&t.status?t.responseJSON.errors:[]).promise()})},loadSSO:function(){return PlexAjax.getUserAPIPromise({url:PlexUtils.getAPIUrl()+"/api/v2/users/signin",method:"POST",data:{login:"",password:"",noGuest:!0,skipAuthentication:!0},dataType:"json",xhrFields:{withCredentials:!0}}).then(function(t){var r=PlexModel.getSignInModel();r.set({ssoMyPlexAccessToken:t.authToken,ssoEmail:t.email});var n="0"!==t.rememberExpiresAt;return t=e.extend({roles:[]},t),Plex.setAuthInfo(t,n),r.get()})}};t.PlexSignIn=r}(jQuery,window),function(e,t){var r={SIGN_OUT:"signout",signOut:function(t){return PlexAjax.getUserAPIPromise({url:PlexUtils.getAPIUrl()+"/api/v2/users/signout",type:"DELETE",dataType:"json",xhrFields:{withCredentials:!0},headers:{"X-Plex-Token":t}}).then(function(e){},function(t){return e.Deferred().reject(t&&t.status?t.responseJSON.errors:[]).promise()})}};t.PlexSignOut=r}(jQuery,window),function(e,t){var r={SIGN_UP:"signup",signUp:function(n,o){return PlexAjax.getUserAPIPromise({url:PlexUtils.getAPIUrl()+"/api/v2/users",type:"POST",data:n,dataType:"json",xhrFields:{withCredentials:!0}}).then(function(e){return t.PlexNewUser=!0,{authToken:e.authToken,uuid:e.uuid,metricsEvent:r.SIGN_UP,metricsMode:"password",isFirstRun:o.isFirstRun,response:e}},function(t){return e.Deferred().reject(t&&t.status?t.responseJSON.errors:[]).promise()})}};t.PlexSignUp=r,t.PlexNewUser=!1}(jQuery,window),function(e,t){var r={resetPassword:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return PlexAjax.getUserAPIPromise({url:PlexUtils.getAPIUrl()+"/api/v2/users/password",type:"POST",data:{email:e.email}})}};t.PlexReset=r}(jQuery,window);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};!function(e,t){function r(r){return function(n,o,s){var a=PlexModel.getSignInModel(),d=o.formData,l=o.options,u=d.providerToken,c=d.password,f=l.providerID,g=(l.forwardUrl,{isBusy:!0,errorMessage:null,providerID:f,providerToken:u});a.set(g),r(d,l,n).then(function(r){var n=r.metricsEvent,o=r.metricsMode,d=r.isFirstRun,l=r.authToken,u=r.uuid,c=r.response;PlexMetrics.track(n,n,{properties:{mode:o,firstRun:d}}),PlexHelpers.trackMetricsEvents();var g=Cookies.get("plex_tv_cj");g&&(g=JSON.parse(g));var p=null;void 0!==g&&void 0!==g.CJEVENT&&(p=g.CJEVENT),t.PLEX_USER_UUID=u,t.PLEX_CJ_EVENT=p,t.PLEX_HAS_CJ_COOKIE=!!g;var h=i[n];h&&PlexMetrics.pushEvent(h),a.set({isSuccess:!0,myPlexAccessToken:l,providerID:f}),void 0!==c.created&&a.set({action:c.created?"signup":"signin"});var v="0"!==c.rememberExpiresAt;c=e.extend({roles:[]},c),Plex.setIsSigninIn(),Plex.setAuthInfo(c,v),void 0!==s&&s(a)}).fail(function(e){var t={isBusy:!1};if(!e||PlexHelpers.isUnrecoverable(e,f))t.errorMessage=PlexHelpers.getSignInErrorMessage(e);else if(PlexHelpers.isRecoverableByClearingProviderAuth(e,f)){var r=PlexModel.getFedAuthProviderModel(f);r.set({providerToken:null}),t.errorMessage=PlexHelpers.getSignInErrorMessage(e)}else!c&&PlexHelpers.isAdditionalAuthNeeded(e)?(t.isAdditionalAuthNeeded=!0,t.isAdditionalAuthPassword=PlexHelpers.isAdditionalAuthPassword(e),t.additionalAuthEmail=PlexHelpers.additionalAuthEmail(e),t.additionalAuthProviderIDs=PlexHelpers.additionalAuthProviderIDs(e)):PlexHelpers.isIgnorable(e)||(t.errorMessage=PlexHelpers.getSignInErrorMessage(e));a.set(t),void 0!==s&&s(a,e)})}}function n(e){var t=Plex.getSignInPage("/?"),r={forwardUrl:e},n=function e(t,r){var n,o=[];for(n in t)if(t.hasOwnProperty(n)){var i=r?r+"["+n+"]":n,s=t[n];o.push(null!==s&&"object"===(void 0===s?"undefined":_typeof(s))?e(s,i):encodeURIComponent(i)+"="+encodeURIComponent(s))}return o.join("&")};PlexSignOut.signOut(Plex.getAuthToken()).always(function(){Plex.removeAuthInfo(),void 0!==e&&(t+=n(r),PlexUtils.redirect(t))})}var o,i=(o={},_defineProperty(o,PlexSignUp.SIGN_UP,"SignUpSuccess"),_defineProperty(o,PlexSignIn.SIGN_IN,"SignInSuccess"),o),s=function(e){return e}({loadProvider:function(e,t){var r=e.options,n=r.providerID,o=PlexModel.getFedAuthProviderModel(n);o.set(_extends({isLoading:!0,isError:!1},PlexAuthFederated.federatedAuthProviders[n])),(0,PlexAuthFederated.LOAD_FEDERATED_AUTH_PROVIDER_HELPERS[n])().then(function(e){o.set(_extends({isLoading:!1,isError:!1},e)),t(n)},function(e){o.set({isLoading:!1,isError:!0}),t(n,e)})},authProvider:function(e,t,n){var o=t.options,i=o.providerID,s=PlexModel.getFedAuthProviderModel(i);return s.set({isLoading:!0}),r(function(){var e=PlexAuthFederated.USE_FEDERATED_AUTH_PROVIDER_HELPERS[i],t=e.apply(void 0,arguments);return t.fail(function(e){s.set({isLoading:!1})}),t})(e,t,n)},signin:r(PlexSignIn.signIn),signup:r(PlexSignUp.signUp),signout:function(e){n(e)},reset:function(e,t,r){var n=PlexModel.getSignInModel();n.set({isBusy:!0,isResetPasswordError:!1}),PlexAjax.minDuration(PlexReset.resetPassword(t.formData),1e3).done(function(){n.set({isResetPasswordSubmitted:!0}),PlexHelpers.trackMetricsEvents()}).fail(function(){n.set({isResetPasswordError:!0})}).always(function(e,t){n.set({isBusy:!1}),r(n,e)})},trackClicks:function(t,r,n){var o={context:e(location).attr("origin")+e(location).attr("pathname")+(n?r+"[modal]":"")};if("signup"!==t&&("signin"!==t||"signup"===r)){var i={reset:"forgotPassword","terms-of-service":"termsOfService","privacy-policy":"privacyPolicy",signin:"signIn"};t=void 0!==i[t]?i[t]:t,PlexMetrics.track("click",t,{properties:o})}}});t.PlexSignInActions=s}(jQuery,window);var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};!function(e,t){function r(t,r){var n={fedAuthModal:".modal-fedauth",fedAuthRemodal:".remodal-fedauth",panelRightTop:".fedauth-panel-top",panelLeft:".fedauth-panel-left",panelRight:".fedauth-panel-right",panelRightBottom:".fedauth-panel-bottom",fedAuthTitle:".fedauth-title",fedAuthTitleDesc:".fedauth-title-desc",toggleForm:".toggle-form",fedAuthForm:".fedauth-form",fedAuthFormSuccess:".fedauth-form-success",fedAuthActionSuccess:".fedauth-form-success .action-success",passwordFieldWraper:".fedauth-form-field-password",togglePasswordField:".fedauth-form-field-password .show-hide-password",passwordInput:".fedauth-form-field-password #password",passwordStrengthTitle:".fedauth-form-field-password .strength-title",passwordStrengthBar:".fedauth-form-field-password .strength-bar",passwordStrengthMeter:".fedauth-form-field-password .meter",fedAuthFieldWraper:".fedauth-form-field",fedAuthFieldsWraper:".fedauth-form-fields",fedAuthField:"input.fedauth-field",fedAuthAction:".fedauth-action",fedAuthBtWrapper:".fedauth-button",fedAuthButton:".fedauth-button.button",fedAuthActionButton:".fedauth-button.basic-action button",fedAuthProviderButton:".fedauth-button.fedauth-action button",fedauthActionToggle:".fedauth-toggle",resetComplete:".reset-complete-dynamic",verifyAccount:".verify-account-dynamic",verifyAccountUser:".verify-account-dynamic .verify-user",verifyAccountProvider:".verify-account-dynamic .verify-provider"};return void 0!==r?n[t]:e(n[t])}function n(n,o,l){function u(e){if(e=void 0!==e?e.get():signinPlexModel.getSignInModel().get(),l(),e.isSuccess)o(e);else{if(e.isAdditionalAuthPassword){var t=e.additionalAuthEmail,n=e.providerID,i=r("verifyAccount","classname"),s=r("verifyAccountUser"),d=r("verifyAccountProvider");PlexModel.getSignInModel().set({action:"signin"}),m(E.find("."+n),!1,e.isError),a(i,"provider-password"),s.text(t),d.text(n.charAt(0).toUpperCase()+n.slice(1))}e.errorMessage&&w(e.errorMessage.code,e.errorMessage.message)}}function c(e,t){var r=PlexModel.getSignInModel(),n=PlexModel.getFedAuthProviderModel(e),o={forwardUrl:PlexUtils.getParam("forwardUrl"),isFirstRun:!1,providerID:e};r.get().isAdditionalAuthNeeded||r.reset(),PlexSignInActions.authProvider(n,{options:o,formData:t},u)}function f(e){return PlexModel.getSignInModel().get().action===e}var g=r("fedAuthModal"),p=r("fedAuthRemodal"),h=r("panelRight"),x=r("fedAuthForm"),y=r("fedAuthField"),E=r("fedAuthAction"),T=r("fedAuthActionButton"),F=r("fedAuthFieldWraper","classname"),k=r("fedAuthActionButton","classname"),U=r("fedAuthProviderButton","classname"),C=r("toggleForm","classname"),D=r("passwordInput","classname"),j=r("togglePasswordField","classname"),R=r("passwordInput"),_="";s(null,n),g.show(),p.find(".remodal-close").fadeIn("slow"),e(document).on("click",C,{panel:h},function(e){e.preventDefault(),s(e,null,x)}),e(document).on("touchstart mousedown",k+":not(.disabled, .isLoading)",function(e){e.preventDefault(),x.validate()}),e(document).on("click",U+":not(.disabled, .isLoading)",function(){var t=e(this).data("provider"),r={provider:t,password:""};P(e(this)),c(t,r)}),e.validator.addMethod("emailFormat",function(e,t,r){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},".email-format"),e.validator.addMethod("invalidExists",function(t,r,n){return!e(r).parent().is(".temp-email-exists")},".email-exists"),e.validator.addMethod("checkEmail",function(t,r,n){return _===t?!e(r).parent().is(".email-exists"):(e.ajax({url:PlexUtils.getAPIUrl()+"/users/check_email.json",headers:{"X-Plex-Product":"Plex Web","X-Plex-Client-Identifier":Plex.getClientIdentifier()},type:"GET",data:{email:t},complete:function(n){_=t,e(r).parent().removeClass("email-exists temp-email-exists"),x.off("keyup.validator");var o=function(){e(r).parent().removeClass("temp-email-exists")};200!==n.status&&(e(r).parent().addClass("email-exists temp-email-exists"),x.on("keyup.validator",e(r),o)),e(r).valid()}}),!1)},".email-validating"),e.extend(e.validator.messages,{email:".email-format"}),x.validate({debug:!0,onkeyup:function(){return M=!0,!0},rules:{email:{required:{depends:function(e){return!f("signin")}},emailFormat:{depends:function(e){return!f("signin")}},invalidExists:{depends:function(e){return f("signup")}},checkEmail:{depends:function(e){return f("signup")}}},login:{required:{depends:function(e){return f("signin")}}},password:{required:!0,minlength:{param:S,depends:function(e){return f("signup")}}}},messages:{email:{required:".email-required",emailFormat:".email-format",checkEmail:".email-validating",invalidExists:".email-exists"},login:{required:".login-required"},password:{required:".password-required",minlength:".password-length"}},showErrors:function(r,n){void 0!==t.event&&"submit"===t.event.type&&A(),e.each(this.validElements(),function(t,r){i(e(r))}),e.each(n,function(t,r){"checkEmail"!==r.method&&i(e(r.element),r.message)})},submitHandler:function(t){if(!T.is(".isLoading, .disabled")){var n=_extends({},function(e){for(var t={},r=0;r<e.length;r++)t[e[r].name]=e[r].value;return t}(e(t).serializeArray())),i=PlexModel.getSignInModel(),s=i.get();if(P(T),s.isAdditionalAuthNeeded){var d=PlexModel.getFedAuthProviderModel(s.providerID).get(),l={login:d.email,provider:d.providerID,providerToken:d.providerToken};n=e.extend(n,l),c(s.providerID,n)}else{var u=function(e,t){var n=e.get(),i=r("resetComplete","classname");m(),n.isResetPasswordSubmitted?n.isResetPasswordError?w(99):a(i):n.errorMessage?w(n.errorMessage.code,n.errorMessage.message):n.isSuccess?o(n):w("","Authentication Error")};(0,PlexSignInActions[s.action])(i,{options:{isFirstRun:!1},formData:n},u)}}}}),e(document).on("keyup",D,function(t){f("signup")&&(clearTimeout(b),b=setTimeout(function(){var n=e(t.currentTarget),o=zxcvbn(n.val()),i=r("passwordStrengthBar");if(I=o.score,!n.val())return e(".meter").animate({width:"100%",marginLeft:"0%"},{complete:function(){i.fadeOut()}}),v("hide"),void(I=-1);0==I?I+=1:I>2&&(I=5),v("show")}.bind(this),350))}).focus(function(e){f("signup")&&v("show")}),e(document).on("click",j,function(){var t=e(".icon-toggle-pass");return"text"===R.attr("type")?(R.attr("type","password"),R.closest(F).removeClass("pass-toggle-on").addClass("pass-toggle-off")):(R.attr("type","text"),R.closest(F).removeClass("pass-toggle-off").addClass("pass-toggle-on")),t.toggleClass(t.data("show")+" "+t.data("hide")),!1}),e(document).on("keyup","input",function(){"login"!==e(this).attr("id")&&"email"!==e(this).attr("id")||y.filter(".fedoff").not("[id=password]").val(e(this).val())}).on("focus","input",function(){var t=e(this).closest(F),r=t.find(".toggable-icon");t.addClass("field-active"),d(r,"default")}).on("blur","input",function(){e(this).closest(F).removeClass("field-active")})}function o(){var e=r("fedAuthFieldWraper");e.removeClass("field-active field-error field-success"),e.find("label:not(.fedoff)").hide(),e.find("label.default-label:not(.fedoff)").show(),d(e.find(".toggable-icon"),"default")}function i(t,r,n){var o=PlexModel.getSignInModel().get(),i=t.parent(),s=i.find(".toggable-icon"),a=e(".validation-errors");if(r)i.find(".default-label:not(.fedoff)").hide(),n?i.find(r).show():(i.find(".alt-label").removeClass("alt-label").hide(),i.find(".error").html(a.find(r).text()).show(),i.removeClass("field-success").addClass("field-error"));else{if(t.val()&&t.is(":focus")&&i.find("label.alt-label").length)return;i.removeClass("field-success field-error"),i.find(".error").html("").hide(),"signup"===o.action&&t.val()&&i.addClass("field-success"),i.find(".alt-label:not(.fedoff)").removeClass("alt-label").hide(),i.find(".default-label:not(.fedoff)").show()}t.is(":focus")||d(s,i.is(".field-error")?"error":i.is(".field-success")?"success":"default")}function s(t,r,n){var o=PlexModel.getSignInModel();void 0!==t&&t?(t.preventDefault(),r=e(t.currentTarget).hasClass("reset-password")?"reset":e(t.currentTarget).hasClass("signin")?"signin":"signup",PlexSignInActions.trackClicks(r,E.context,E.isModal)):"#resetPassword"===PlexUtils.getURLHash()&&(r="reset");var i=PlexModel.getFormModel(r),s=i.class;o.reset(),PlexModel.getSignInModel().set({action:r,isModal:E.isModal,redirectWeb:!(!E.data.redirectWeb||"0"===E.data.redirectWeb)}),a(s),M&&void 0!==n&&n.valid()}function a(e,t){var n=PlexModel.getSignInModel().get(),i=r("panelRight");t=void 0!==t?t:n.action,i.find(".toggable:not("+e+")").addClass("fedoff"),i.find(".toggable"+e).removeClass("fedoff"),i.find("form").attr("data-action",n.action),i.removeClass(function(e,t){return(t.match(/(^|\s)active-action-\S+/g)||[]).join(" ")}),i.addClass("active-action-"+t),A(),l(!0),o(),v("hide")}function d(t,r){e.each(t,function(t,n){var o=e(n);e.each(o.data(),function(e,t){e===r?o.addClass(t):o.removeClass(t)})})}function l(e){c(e),f(e),g(e,e),p(e),h(!e)}function u(e,t){h(!0,e),void 0!==t&&t.length>0&&t.find(".remodal-close").hide()}function c(e){r("panelRightTop").toggle(e)}function f(e){r("panelRightBottom").toggle(e)}function g(e,t){var n=r("fedAuthTitle"),o=r("fedAuthTitleDesc");n.toggle(e),o.toggle(t)}function p(e){r("fedAuthFieldsWraper").toggle(e)}function h(e,t){var n=r("fedAuthFormSuccess"),o=r("fedAuthActionSuccess");n.toggle(e),e&&void 0!==t&&(o.toggle(!1),o.filter("."+t).show())}function v(e){var t=PlexModel.getSignInModel().get(),n=r("passwordFieldWraper"),o=r("passwordInput"),s=r("togglePasswordField"),a=r("passwordStrengthTitle"),d=r("passwordStrengthMeter"),l=r("passwordStrengthBar"),u=n.not(".field-error").find(".strength-title"),c={0:"poor",1:"poor",2:"weak",5:"strong"};if(n.removeClass("strength-poor strength-weak strength-strong"),"signup"!==t.action)return void s.addClass("fedoff");if(o.val()?s.removeClass("fedoff"):s.addClass("fedoff"),I>-1&&"show"===e){l.fadeIn(),a.removeClass("alt-label"),u.filter(":not(.strength-"+c[I]+")").hide();var f=u.filter(".strength-"+c[I]);f.addClass("alt-label"),i(o,f,!0),n.addClass("strength-"+c[I]),d.animate({width:100-20*I+"%",marginLeft:20*I+"%"})}else i(o)}function m(t,n,o){var i=PlexModel.getSignInModel(),s=i.get(),d=PlexModel.getFormModel(s.action),l=r("fedauthActionToggle"),u=r("fedAuthFieldsWraper"),c=r("panelRight");u.is(":visible")&&l.show(),n&&void 0!==t&&t.removeClass("preLoading"),t=c.find("button.isLoading:not(.preLoading)"),t.find(".loader").remove(),t.removeClass("isLoading"),t.each(function(t,r){var n=e(r).find(".button-label:not(.fedoff)");n.html(n.data("label"))}),void 0!==n&&n||c.find(".temp-disabled").removeClass("disabled temp-disabled").attr("disabled",!1),o||t.filter(".disabled").removeClass("disabled temp-disabled"),a(d.class)}function P(t,n){var o=t.find(".button-label:not(.fedoff)"),i=r("panelRight");A(),n?(t.addClass("preLoading"),x(t)):x(i.find("button"),!0),t.is(".isLoading")||(t.addClass("isLoading"),o.attr("data-label",o.html()).html(e(".field-spinner.loading").html()))}function x(t,n){var o=r("fedauthActionToggle"),i=r("fedAuthField");t.filter(":not(.disabled):not(.isLoading)").addClass("disabled temp-disabled"),i.filter(":not(.disabled):not(.isLoading)").addClass("disabled temp-disabled"),n&&(o.hide(),e(".disabled.temp-disabled").attr("disabled",!0))}function A(){e(".fedauth-form-errors, .validation-errors, .form-error").hide()}function w(t,r){e(".fedauth-form-errors.form-error").hide(),e(".fedauth-form-errors").show(),void 0===t&&(t=""),void 0===r&&(r=""),e(".plex-error-"+t).length?e(".plex-error-"+t).show():r&&e(".plex-error-other").text(r).show()}function y(e,t,r,n){t=void 0!==t&&t,E.start(e,t,r,n)}var b=0,I=-1,S=8,M=!1,E={version:1,isModal:!1,context:"signin",data:{redirectWeb:!0},start:function(o,i,s,d){function l(r){var n=!0,o="",i=e("[data-remodal-id="+t.modalFedAuth+"]"),s=i.remodal();void 0!==i&&i.length>0&&i.find(".remodal-close").hide(),r.ssoMyPlexAccessToken&&e(".status-check").text("You are already signed in, please wait ..."),a(PlexModel.getFormModel(r.action).class),u(r.action,i),void 0!==s?(setTimeout(function(){s.close()},1e3),n=!1):setTimeout(function(){},1e3),PlexUtils.getParam("forwardUrl")?o=PlexUtils.getParam("forwardUrl"):PlexUtils.getParam("forward")&&"web"===(o=PlexUtils.getParam("forward"))&&(o=PlexUtils.getWebUrl()),e(document).trigger("fedAuthFinished",[{action:r.action}]),"1"==E.version&&(o?PlexUtils.redirect(o):PlexUtils.isMobile()&&"signup"===r.action?PlexUtils.redirect("/onboard/mobile/"):"signup"===r.action&&r.redirectWeb&&!PlexUtils.getParam("skipWeb")?PlexUtils.redirect(PlexUtils.getWebUrl()):n&&PlexUtils.redirect())}function c(){m()}function f(t,r){var n=e("."+t).find("button"),o=PlexModel.getFedAuthProviderModel(t).get();o.isError&&void 0!==r&&w(r[0].code,r[0].message),m(n,!0,o.isError)}function g(){var e=r("fedAuthProviderButton");Plex.isSignedIn()&&Plex.removeAuthInfo(!0),P(e.filter(".google"),!0),PlexSignInActions.loadProvider({options:{providerID:"google"}},f),P(e.filter(".facebook"),!0),PlexSignInActions.loadProvider({options:{providerID:"facebook"}},f)}if(E.version=d||E.version,E.isModal=i,E.data=e.extend(E.data,s),M=!1,PlexUtils.getParam("reset")&&(o="reset"),E.context=o,"https:"!==t.location.protocol)return w("","Insecure protocol");e(document).ready(function(){n(o,l,c)}),PlexSignIn.loadSSO().then(l,function(e){var t=e.status;400===t||401===t?g():w("","Authentication Error")})}}
;if(void 0!==t.modalFedAuth&&void 0===t.checkoutFedAuth){var T={action:"signin",panels:"all"};e(document).on("fedauthModalOpened",function(n,o){o=e.extend(T,o);var i=e("[data-remodal-id="+t.modalFedAuth+"]");if(void 0!==i.attr("data-last-action")&&(o.action=i.attr("data-last-action"),i.removeAttr("data-last-action")),"right"===o.panels){r("getElement").hide()}PlexMetrics.track("view",o.action,{properties:{page:plex_l10n.curr_page+"[modal]"}}),y(o.action,!0,o)})}else e(document).on("fedAuthOpened",function(e,t,r){y(t,!1,{},r)});e(document).ready(function(){e(document).on("click",".signin:not(.action), .go-signin",function(){return e(this).trigger("fedAuth",[{action:"signin",panels:"all"}]),!1}),e(document).on("click",".signup:not(.action), .go-signup",function(){return e(this).trigger("fedAuth",[{action:"signup",panels:"all",redirectWeb:e(this).data("redirectweb")}]),!1}),e(document).on("click",".signout, .go-signout",function(){return PlexView.loading(),PlexSignInActions.signout(),!1}),e(document).on("click",".signout-other",function(){var t=location.href;return PlexView.loading(),void 0!==e(this).data("forward")&&(t=""),PlexSignInActions.signout(t),!1}),void 0!==t.modalFedAuth&&e(document).on("click",".remodal-privacy-policy, .remodal-terms",function(){var r=e(".remodal[data-remodal-id="+t.modalFedAuth+"]").remodal();"opened"===r.getState()&&(PlexSignInActions.trackClicks(e(this).data("utm"),"signup",!0),e(document).on("closed",".remodal[data-remodal-id=remodal-privacy-policy], .remodal[data-remodal-id=remodal-terms]",function(n){e(".remodal[data-remodal-id="+t.modalFedAuth+"]").attr("data-last-action","signup"),r.open(),e(this).off("closed")}))})})}(jQuery,window);